

IF(BUILDER_NLS_ENABLE)

    FIND_PROGRAM(MSGFMT_EXECUTABLE msgfmt)
    
    FILE(GLOB BUILDER_PO_FILES ${CMAKE_CURRENT_SOURCE_DIR}/*.po)
    
    FOREACH(BUILDER_PO_INPUT ${BUILDER_PO_FILES})
    
        GET_FILENAME_COMPONENT(BUILDER_PO_INPUT_BASE ${BUILDER_PO_INPUT} NAME_WE)
                
        SET(BUILDER_MO_OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/${BUILDER_PO_INPUT_BASE}.mo)
        
        ADD_CUSTOM_COMMAND(DEPENDS ${BUILDER_PO_INPUT}
                           COMMAND ${MSGFMT_EXECUTABLE} -c -o ${BUILDER_MO_OUTPUT} ${BUILDER_PO_INPUT} 
                           OUTPUT ${BUILDER_MO_OUTPUT})
        
        ADD_CUSTOM_TARGET(i18n-${BUILDER_PO_INPUT_BASE} ALL 
                          COMMENT "Building i18n messages for ${BUILDER_PO_INPUT_BASE}"
                          DEPENDS ${BUILDER_MO_OUTPUT})
        
        INSTALL(FILES ${BUILDER_MO_OUTPUT} DESTINATION "${CMAKE_INSTALL_PREFIX}/share/locale/${BUILDER_PO_INPUT_BASE}/LC_MESSAGES RENAME ${BUILDER_NLS_PACKAGE}.mo")
        
    ENDFOREACH(BUILDER_PO_INPUT ${BUILDER_PO_FILES})

ENDIF(BUILDER_NLS_ENABLE)