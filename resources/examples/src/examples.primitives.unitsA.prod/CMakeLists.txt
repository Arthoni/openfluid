CMAKE_MINIMUM_REQUIRED (VERSION 2.6)

INCLUDE(CMake.in.config)

PROJECT(${FUNC_ID} CXX)

FIND_PACKAGE(PkgConfig REQUIRED)
PKG_CHECK_MODULES(ofelib ofelib)

IF(ofelib_FOUND) 

INCLUDE_DIRECTORIES(${ofelib_INCLUDE_DIRS})
  
# process fortran source files if present 
IF(FUNC_FORTRAN)
  ENABLE_LANGUAGE(Fortran)
  SET(CMAKE_Fortran_FLAGS_RELEASE "-funroll-all-loops -fno-f2c -O3")
  SET(FORTRAN_LINK_LIBS "gfortran")
ENDIF(FUNC_FORTRAN)


ADD_LIBRARY(${FUNC_ID} MODULE ${FUNC_CPP} ${FUNC_FORTRAN})
ADD_DEFINITIONS(${ofelib_CFLAGS})
SET_TARGET_PROPERTIES(${FUNC_ID} PROPERTIES PREFIX "" SUFFIX "${CMAKE_SHARED_LIBRARY_SUFFIX}mpi")
TARGET_LINK_LIBRARIES(${FUNC_ID} ${ofelib_LIBRARIES} ${FORTRAN_LINK_LIBS})

IF(INSTALL_PATH)
  INSTALL(TARGETS ${FUNC_ID} DESTINATION "${INSTALL_PATH}")
ENDIF(INSTALL_PATH)  

ENDIF(ofelib_FOUND)